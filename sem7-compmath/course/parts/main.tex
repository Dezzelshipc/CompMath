\section{Основная часть}

\subsection{Постановка задачи}
    Найти решение обыкновенного дифференциального уравнения 2 порядка с краевыми условиями вида:
    \[
        \begin{cases}
            y''(x) + q(x) y(x) = r(x), \\
            a_1 y(a) + b_1 y'(a) = c_1, \\
            a_2 y(b) + b_2 y'(b) = c_2.
        \end{cases}
    \]

\subsection{Описание алгоритма}
    Сплайн-разностная схема состоит в нахождении приближённого решения в виде кубического сплайна \( S(x) \in C^2[a,b] \) на сетке \\ \( \Delta: a = x_0 < x_1 < \dots < x_{N-1} < x_N = b \) на этом отрезке.

    Для нахождения сплайна используем метод коллокации. На отрезке выбираем \( N+1 \) узлов коллокации \( \xi_k \), в которых будет удовлетворятся уравнение
    \( S''(\xi_k) + q(\xi_k) S(\xi_k) = r(\xi_k), \, k \in \overline{0,N} \). Вместе с краевыми условиями будем иметь размерность \( N+3 \), которая определяет сплайн.

    Находить сплайн будем через моменты. На интервале \( [x_i, x_{i+1}] \) имеет вид:
    \[
        S(x) = y_i(1-t) + y_{i+1} t - \frac{h^2_i}{6} t (1-t) \left[ (2-t) M_i + (1+t)M_{i+1} \right],
    \]
    \[
        h_i = x_{i+1} - x_i, \quad t = \frac{x - x_i}{h_i}, \quad M_i = S''(x_i)
    \]

    Для простоты возьмём узлы коллокации, совпадающие с узлами сетки \( x_i = \xi_i \), тогда уравнение в узле \(i = \overline{0,N}\) будет иметь вид \( M_i + q_i y_i = r_i \). Зная вид трёхдиагональной системы уравнений для нахождения моментов через известные значения функции в узлах, подставив, получим систему:
    
    \begin{multline*}
    (1-\mu_i)\left( 1 + \frac{h^2_{i-1}}{6} q_{i-1} \right)y_{i-1} - \left( 1 - \frac{h_i h_{i-1}}{3} \right) y_i + \mu_i \left( 1 + \frac{h^2_i}{6} q_{i+1} \right)y_{i+1} = \\ = \frac{h_{i-1} h_{i}}{6} (\mu_i r_{i+1} + 2r_i + (1-\mu_i)r_{i+1}), \quad i = \overline{1,N-1},
    \end{multline*}
    где \( \mu_i = \frac{h_{i-1}}{h_{i-1} + h_i} \).

    Для краевых условий имеем
    \[
        y_0\left[ a_1 h_0 - b_1 \left( 1 - \frac{1}{3} q_0 h^2_0 \right) \right] + y_1 b_1 \left( 1 + \frac{1}{6} q_1 h_0^2 \right) = c_1 h_0 + \frac{1}{6} b_1 h_0^2 ( 2 f_0 + f_1 ),
    \]
    \begin{multline*}
        y_{N-1} b_2 \left( -1 - \frac{1}{6} h^2_{N-1} q_{N-1} \right) + y_N \left[ a_2 h_{N-1} + b_2 \left( 1 - \frac{1}{3} h^2_{N-1} q_N \right) \right] = \\ = c_2 h_{N-1} - \frac{1}{6} b_2 h^2_{N-1} (f_{N-1} + 2 f_N).
    \end{multline*}

    Из данной системы методом прогонки находим \( y_i, i=\overline{0,N} \), затем \( M_i \) и получаем приближённое решение в виде кубического сплайна.

    Для упрощения вычислений будем использовать равномерную сетку. Поскольку полученный кубический сплайн можно вычислить в любой точке отрезка, поэтому между узлами сетки будем использовать всегда 100 точек равномерной сетки.

    \subsubsection{Погрешность вычислений}
    При соблюдении условий диагонального преобладания
    \[
        b_1 \leq 0, \quad b_2, a_j \geq 0, \quad |a_j| + |b_j| = 0, \quad j\in\{1,2\}; \quad q(x) \leq q < 0
    \]
    и если точное решение \( y \in C^2 W^4_{\Delta, \infty} [a, b] \), то \( \left\| S(x) - y(x) \right\|_C = O\left( \overline{h}^2 \right) \).

\subsection{Вычислительные эксперименты}
Для вычислительных экспериментов будут использованы дифференциальные уравнения, предложенные на практических занятиях по математическому и компьютерному моделированию. Данные примеры можно найти в Приложениях в секции <<\ref{examples} Примеры задач>>, а некоторые графики примеров в <<\ref{plots} Графики решений>>.

В таблице \ref{res-tab} приведены результаты численного решения задач при разном количестве узлов сетки и соответствующая максимальная погрешность по модулю.

\begin{table}[H]
\begin{center}
\begin{tabular}{|c|c|c|}
    \hline
    № задачи & \( N \) & \( \max_{x \in [a,b]} \left| S(x) - y(x) \right| \) \\ \hline
    1 & 10 & 1.19e-3 \\ \hline
    1 & 100 & 1.24e-5 \\ \hline
    1 & 1000 & 1.24e-7 \\ \hline
    2 & 10 & 1.45e-3 \\ \hline
    2 & 100 & 1.27e-5 \\ \hline
    2 & 1000 & 1.25e-7 \\ \hline
    3 & 10 & 4.92e-3 \\ \hline
    3 & 100 & 5.25e-5 \\ \hline
    3 & 1000 & 5.28e-7 \\ \hline
    3 & 5000 & 2.12e-8 \\ \hline

\end{tabular}
\caption{Таблица результатов}\label{res-tab}
\end{center}
\end{table}

\subsubsection{Анализ результатов}
    Как можно увидеть, при увеличении количества узлов сетки погрешность уменьшается, что достаточно соответствует теоретической погрешности.